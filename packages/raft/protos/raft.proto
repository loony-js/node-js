syntax = "proto3";

package raft;

service RaftService {
  rpc IsAlive(Empty) returns (Alive);
  rpc OnHeartbeat(Heartbeat) returns (HeartbeatResponse);
  rpc OnVoteRequest(VoteRequest) returns (VoteRequestResponse);
  rpc OnAppendEntries(AppendEntriesRequest) returns (AppendEntriesResponse);
}

message Alive {
  bool alive = 1;
  NodeInfo node = 2;
}

message NodeInfo {
  uint32 length = 1;
}

message Heartbeat {
  uint32 term = 1;
  uint32 leaderId = 2;
}
message HeartbeatResponse {
  bool result = 1;
}

message VoteRequest {
  uint32 term = 1;
  uint32 candidateId = 2;
}
message VoteRequestResponse {
  bool voteGranted = 1;
}


message AppendEntriesRequest {
  int32 term = 1;
  int32 leaderId = 2;
  int32 prevLogIndex = 3;
  int32 prevLogTerm = 4;
  string entries = 5;
  int32 leaderCommit = 6;
}

message LogEntry {
  int32 term = 1;
  string command = 2;
}

message AppendEntriesResponse {
  bool success = 1;
}

message Empty {}